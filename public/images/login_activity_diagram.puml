
@startuml
start
:Truy cập trang đăng nhập;
:Chọn phương thức đăng nhập;
if (Phương thức đăng nhập?) then (Email)
    :Nhập thông tin đăng nhập (email, mật khẩu);
    :Kiểm tra dữ liệu đầu vào;
    if (Dữ liệu hợp lệ?) then (yes)
        :Kiểm tra thông tin đăng nhập;
        if (Thông tin đúng?) then (yes)
            :Phân quyền theo vai trò;
            switch (Vai trò)
                case (Khách hàng)
                    :Chuyển hướng đến trang khách hàng;
                case (Admin)
                    :Chuyển hướng đến trang admin;
                case (Đại lý)
                    :Chuyển hướng đến trang đại lý;
            endswitch
        else (no)
            :Thông báo lỗi đăng nhập;
        endif
    else (no)
        :Thông báo lỗi dữ liệu;
    endif
else (Google)
    :Xác thực Google;
    if (Xác thực thành công?) then (yes)
        :Phân quyền theo vai trò;
        switch (Vai trò)
            case (Khách hàng)
                :Chuyển hướng đến trang khách hàng;
            case (Admin)
                :Chuyển hướng đến trang admin;
            case (Đại lý)
                :Chuyển hướng đến trang đại lý;
        endswitch
    else (no)
        :Thông báo lỗi đăng nhập;
    endif
endif
end
@enduml
