
@startuml
start
:Truy cập trang đăng nhập;
:Chọn phương thức đăng nhập;
if (Phương thức đăng nhập?) is (Email) then
    :Nhập thông tin đăng nhập (email, mật khẩu);
    :Kiểm tra dữ liệu đầu vào;
    if (Dữ liệu hợp lệ?) is (<color:green>yes) then
        :Kiểm tra thông tin đăng nhập;
        if (Thông tin đúng?) is (<color:green>yes) then
            :Phân quyền theo vai trò;
            switch (Vai trò)
                case (Khách hàng)
                    :Chuyển hướng đến trang khách hàng;
                case (Admin)
                    :Chuyển hướng đến trang admin;
                case (Đại lý)
                    :Chuyển hướng đến trang đại lý;
            endswitch
        else is (<color:red>no)
            :Thông báo lỗi đăng nhập;
            :Quay lại nhập thông tin;
        endif
    else is (<color:red>no)
        :Thông báo lỗi dữ liệu;
        :Quay lại nhập thông tin;
    endif
else is (Google)
    :Xác thực Google;
    if (Xác thực thành công?) is (<color:green>yes) then
        :Phân quyền theo vai trò;
        switch (Vai trò)
            case (Khách hàng)
                :Chuyển hướng đến trang khách hàng;
            case (Admin)
                :Chuyển hướng đến trang admin;
            case (Đại lý)
                :Chuyển hướng đến trang đại lý;
        endswitch
    else is (<color:red>no)
        :Thông báo lỗi đăng nhập;
        :Quay lại nhập thông tin;
    endif
endif
end
@enduml
